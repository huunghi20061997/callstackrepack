{"version":3,"file":"convertToRemoteAssets.js","names":["_path","_interopRequireDefault","require","_dedent","_utils","e","__esModule","default","convertToRemoteAssets","assets","assetsDirname","remotePublicPath","resourceDirname","resourceExtensionType","resourceFilename","resourcePath","suffixPattern","pathSeparatorRegexp","assetPath","path","join","replace","publicPathURL","URL","size","getImageSize","asset","JSON","stringify","name","type","httpServerLocation","href","scales","map","scale","height","width","dedent"],"sources":["../../../../src/webpack/loaders/assetsLoader/convertToRemoteAssets.ts"],"sourcesContent":["import path from 'path';\nimport dedent from 'dedent';\nimport { getImageSize } from './utils';\nimport type { Asset } from './types';\n\nexport function convertToRemoteAssets({\n  assets,\n  assetsDirname,\n  remotePublicPath,\n  resourceDirname,\n  resourceExtensionType,\n  resourceFilename,\n  resourcePath,\n  suffixPattern,\n  pathSeparatorRegexp,\n}: {\n  assets: Asset[];\n  assetsDirname: string;\n  remotePublicPath: string;\n  resourceDirname: string;\n  resourceExtensionType: string;\n  resourceFilename: string;\n  resourcePath: string;\n  suffixPattern: string;\n  pathSeparatorRegexp: RegExp;\n}) {\n  const assetPath = path\n    .join(assetsDirname, resourceDirname)\n    .replace(pathSeparatorRegexp, '/');\n\n  // works on both unix & windows\n  const publicPathURL = new URL(path.join(remotePublicPath, assetPath));\n\n  const size = getImageSize({ resourcePath, resourceFilename, suffixPattern });\n\n  const asset = JSON.stringify({\n    name: resourceFilename,\n    type: resourceExtensionType,\n    httpServerLocation: publicPathURL.href,\n    scales: assets.map((asset) => asset.scale),\n    height: size?.height,\n    width: size?.width,\n  });\n\n  return dedent`\n    var AssetSourceResolver = require('react-native/Libraries/Image/AssetSourceResolver');\n    var resolver = new AssetSourceResolver(undefined, undefined, ${asset});\n\n    module.exports = resolver.scaledAssetPath();\n  `;\n}\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,MAAA,GAAAF,OAAA;AAAuC,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAGhC,SAASG,qBAAqBA,CAAC;EACpCC,MAAM;EACNC,aAAa;EACbC,gBAAgB;EAChBC,eAAe;EACfC,qBAAqB;EACrBC,gBAAgB;EAChBC,YAAY;EACZC,aAAa;EACbC;AAWF,CAAC,EAAE;EACD,MAAMC,SAAS,GAAGC,aAAI,CACnBC,IAAI,CAACV,aAAa,EAAEE,eAAe,CAAC,CACpCS,OAAO,CAACJ,mBAAmB,EAAE,GAAG,CAAC;;EAEpC;EACA,MAAMK,aAAa,GAAG,IAAIC,GAAG,CAACJ,aAAI,CAACC,IAAI,CAACT,gBAAgB,EAAEO,SAAS,CAAC,CAAC;EAErE,MAAMM,IAAI,GAAG,IAAAC,mBAAY,EAAC;IAAEV,YAAY;IAAED,gBAAgB;IAAEE;EAAc,CAAC,CAAC;EAE5E,MAAMU,KAAK,GAAGC,IAAI,CAACC,SAAS,CAAC;IAC3BC,IAAI,EAAEf,gBAAgB;IACtBgB,IAAI,EAAEjB,qBAAqB;IAC3BkB,kBAAkB,EAAET,aAAa,CAACU,IAAI;IACtCC,MAAM,EAAExB,MAAM,CAACyB,GAAG,CAAER,KAAK,IAAKA,KAAK,CAACS,KAAK,CAAC;IAC1CC,MAAM,EAAEZ,IAAI,EAAEY,MAAM;IACpBC,KAAK,EAAEb,IAAI,EAAEa;EACf,CAAC,CAAC;EAEF,OAAO,IAAAC,eAAM;AACf;AACA,mEAAmEZ,KAAK;AACxE;AACA;AACA,GAAG;AACH","ignoreList":[]}