{"version":3,"file":"AuxiliaryAssetsCopyProcessor.js","names":["_path","_interopRequireDefault","require","_fsExtra","e","__esModule","default","AuxiliaryAssetsCopyProcessor","queue","constructor","config","filesystem","fs","copyAsset","from","to","logger","debug","ensureDir","path","dirname","copyFile","enqueueAsset","asset","outputPath","assetsDest","push","join","execute","map","work","exports"],"sources":["../../../../src/webpack/plugins/utils/AuxiliaryAssetsCopyProcessor.ts"],"sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { WebpackLogger } from '../../../types';\n\nexport class AuxiliaryAssetsCopyProcessor {\n  queue: Array<() => Promise<void>> = [];\n\n  constructor(\n    public readonly config: {\n      platform: string;\n      outputPath: string;\n      assetsDest: string;\n      logger: WebpackLogger;\n    },\n    private filesystem: Pick<\n      typeof fs,\n      'ensureDir' | 'copyFile' | 'readFile' | 'writeFile'\n    > = fs\n  ) {}\n\n  private async copyAsset(from: string, to: string) {\n    this.config.logger.debug('Copying asset:', from, 'to:', to);\n    await this.filesystem.ensureDir(path.dirname(to));\n    await this.filesystem.copyFile(from, to);\n  }\n\n  enqueueAsset(asset: string) {\n    const { outputPath, assetsDest } = this.config;\n\n    this.queue.push(() =>\n      this.copyAsset(path.join(outputPath, asset), path.join(assetsDest, asset))\n    );\n  }\n\n  execute() {\n    const queue = this.queue;\n    this.queue = [];\n    return queue.map((work) => work());\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,QAAA,GAAAF,sBAAA,CAAAC,OAAA;AAA0B,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAGnB,MAAMG,4BAA4B,CAAC;EACxCC,KAAK,GAA+B,EAAE;EAEtCC,WAAWA,CACOC,MAKf,EACOC,UAGP,GAAGC,gBAAE,EACN;IAAA,KAVgBF,MAKf,GALeA,MAKf;IAAA,KACOC,UAGP,GAHOA,UAGP;EACA;EAEH,MAAcE,SAASA,CAACC,IAAY,EAAEC,EAAU,EAAE;IAChD,IAAI,CAACL,MAAM,CAACM,MAAM,CAACC,KAAK,CAAC,gBAAgB,EAAEH,IAAI,EAAE,KAAK,EAAEC,EAAE,CAAC;IAC3D,MAAM,IAAI,CAACJ,UAAU,CAACO,SAAS,CAACC,aAAI,CAACC,OAAO,CAACL,EAAE,CAAC,CAAC;IACjD,MAAM,IAAI,CAACJ,UAAU,CAACU,QAAQ,CAACP,IAAI,EAAEC,EAAE,CAAC;EAC1C;EAEAO,YAAYA,CAACC,KAAa,EAAE;IAC1B,MAAM;MAAEC,UAAU;MAAEC;IAAW,CAAC,GAAG,IAAI,CAACf,MAAM;IAE9C,IAAI,CAACF,KAAK,CAACkB,IAAI,CAAC,MACd,IAAI,CAACb,SAAS,CAACM,aAAI,CAACQ,IAAI,CAACH,UAAU,EAAED,KAAK,CAAC,EAAEJ,aAAI,CAACQ,IAAI,CAACF,UAAU,EAAEF,KAAK,CAAC,CAC3E,CAAC;EACH;EAEAK,OAAOA,CAAA,EAAG;IACR,MAAMpB,KAAK,GAAG,IAAI,CAACA,KAAK;IACxB,IAAI,CAACA,KAAK,GAAG,EAAE;IACf,OAAOA,KAAK,CAACqB,GAAG,CAAEC,IAAI,IAAKA,IAAI,CAAC,CAAC,CAAC;EACpC;AACF;AAACC,OAAA,CAAAxB,4BAAA,GAAAA,4BAAA","ignoreList":[]}